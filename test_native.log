============================= test session starts =============================
platform win32 -- Python 3.12.1, pytest-9.0.1, pluggy-1.6.0
rootdir: C:\Users\pablo\Movistar Cloud\Gravity\blurtpy
configfile: pytest.ini
collected 6 items

tests\test_native_blurt.py ...FFF                                        [100%]

================================== FAILURES ===================================
_________________ TestNativeBlurt.test_04_transaction_signing _________________

self = <tests.test_native_blurt.TestNativeBlurt testMethod=test_04_transaction_signing>

    def test_04_transaction_signing(self):
        """
        SECURITY & CRYPTO: Create and sign a transaction without broadcasting.
        This verifies the Active Key is valid and the signing mechanism works.
        """
        logger.info("Testing transaction signing (dry-run)...")
        account = Account(ACCOUNT_NAME, blockchain_instance=self.blurt)
    
        # Create a dummy transfer of 0.001 BLURT
        # 'nobroadcast=True' ensures we don't actually spend money, just test the crypto
>       tx = self.blurt.transfer(
            "blurtpybot", 0.001, "BLURT", memo="Native Test Signing", account=ACCOUNT_NAME, nobroadcast=True
        )

tests\test_native_blurt.py:76: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
blurtpy\blurt.py:504: in transfer
    return Account(account, blockchain_instance=self).transfer(to, amount, asset, memo, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
blurtpy\account.py:2885: in transfer
    to = Account(to, blockchain_instance=self.blockchain)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
blurtpy\account.py:104: in __init__
    super(Account, self).__init__(
blurtpy\blockchainobject.py:145: in __init__
    self.refresh()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <Account blurtpybot>

    def refresh(self):
        """ Refresh/Obtain an account's data from the API server
        """
        if not self.blockchain.is_connected():
            return
        self.blockchain.rpc.set_next_node_on_empty_reply(self.blockchain.rpc.get_use_appbase())
        if self.blockchain.rpc.get_use_appbase():
            account = self.blockchain.rpc.find_accounts({'accounts': [self.identifier]}, api="database")
        else:
            if self.full:
                account = self.blockchain.rpc.get_accounts(
                    [self.identifier], api="database")
            else:
                account = self.blockchain.rpc.lookup_account_names(
                    [self.identifier], api="database")
        if self.blockchain.rpc.get_use_appbase() and "accounts" in account:
            account = account["accounts"]
        if account and isinstance(account, list) and len(account) == 1:
            account = account[0]
        if not account:
>           raise AccountDoesNotExistsException(self.identifier)
E           blurtpy.exceptions.AccountDoesNotExistsException: blurtpybot

blurtpy\account.py:132: AccountDoesNotExistsException
_______________ TestNativeBlurt.test_05_missing_key_protection ________________

self = <tests.test_native_blurt.TestNativeBlurt testMethod=test_05_missing_key_protection>

    def test_05_missing_key_protection(self):
        """
        SECURITY: Ensure operations fail safely when the key is missing.
        """
        logger.info("Testing missing key protection...")
        # Instance without keys
        b_no_key = Blurt(node=self.nodes)
    
        with self.assertRaises(MissingKeyError):
>           b_no_key.transfer("blurtpybot", 0.001, "BLURT", account=ACCOUNT_NAME, nobroadcast=True)

tests\test_native_blurt.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
blurtpy\blurt.py:504: in transfer
    return Account(account, blockchain_instance=self).transfer(to, amount, asset, memo, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
blurtpy\account.py:2885: in transfer
    to = Account(to, blockchain_instance=self.blockchain)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
blurtpy\account.py:104: in __init__
    super(Account, self).__init__(
blurtpy\blockchainobject.py:145: in __init__
    self.refresh()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def refresh(self):
        """ Refresh/Obtain an account's data from the API server
        """
        if not self.blockchain.is_connected():
            return
        self.blockchain.rpc.set_next_node_on_empty_reply(self.blockchain.rpc.get_use_appbase())
        if self.blockchain.rpc.get_use_appbase():
            account = self.blockchain.rpc.find_accounts({'accounts': [self.identifier]}, api="database")
        else:
            if self.full:
                account = self.blockchain.rpc.get_accounts(
                    [self.identifier], api="database")
            else:
                account = self.blockchain.rpc.lookup_account_names(
                    [self.identifier], api="database")
        if self.blockchain.rpc.get_use_appbase() and "accounts" in account:
            account = account["accounts"]
        if account and isinstance(account, list) and len(account) == 1:
            account = account[0]
        if not account:
>           raise AccountDoesNotExistsException(self.identifier)
E           blurtpy.exceptions.AccountDoesNotExistsException: blurtpybot

blurtpy\account.py:132: AccountDoesNotExistsException
_________________ TestNativeBlurt.test_06_history_resilience __________________

self = <tests.test_native_blurt.TestNativeBlurt testMethod=test_06_history_resilience>

    def test_06_history_resilience(self):
        """
        PERFORMANCE: Fetch a chunk of history to test API response handling.
        """
        logger.info("Testing history retrieval...")
        account = Account(ACCOUNT_NAME, blockchain_instance=self.blurt)
        # Fetch last 50 ops
>       history = list(account.history(limit=50))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^
E       TypeError: Account.history() got an unexpected keyword argument 'limit'

tests\test_native_blurt.py:103: TypeError
========================= 3 failed, 3 passed in 4.20s =========================
